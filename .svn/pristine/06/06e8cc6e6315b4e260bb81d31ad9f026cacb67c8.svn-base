function getPreAuthDetailListById() {
	
	var txnid = document.getElementById("txnid").value;
    onRegister();
  	$.ajax({
		type: "POST",
		 url:""+$('#ctx').attr('content')+"/getPatientDetailById",
		  data: {
          "txnid": txnid,
        },
           success: function(data){
			offRegister();
            var data1 = jQuery.parseJSON( data );
			if(data1.status=="SUCCESS"){
			var data2 = data1.data;
			console.log("Data "+ data2);
          	document.getElementById("patientName").innerHTML=data2[0].membername;
          	document.getElementById("patientGender").innerHTML=data2[0].gender;
          	document.getElementById("beneficiaryCardId").innerHTML=data2[0].nhaid;
          	document.getElementById("patientId").value=data2[0].patientid;
            document.getElementById("patientImage").src="data:image/jpeg;base64,"+data2[0].photo;
          	document.getElementById("benContactName").innerHTML=data2[0].mobilenumber;
          	document.getElementById("FamilyId").innerHTML=data2[0].member_id;
          	document.getElementById("verified").innerHTML=data2[0].name;
          	document.getElementById("benRegistrationData").innerHTML=data2[0].creation_date;
      		}
      		else{
				offRegister();
			 	alert('API Gateway not respond. Please try again.');
			}
        },
        error: function(e){
          	offRegister();
			alert('API Gateway not respond. Please try again.');
         }
    });
} 

 
function primaryPreAuthDiagnose(){
	var txnid = document.getElementById("txnid").value;
    var primaryDiagnosis = document.getElementById("primaryDiagnosis").value;
	var icdCode = document.getElementById("pidcCodee").value;
	
	if(primaryDiagnosis==""){
		document.getElementById("primaryDiagnosisError").innerHTML = "Please Enter Primary Diagnosis.";
		 document.getElementById("primaryDiagnosis").focus();
        return false;
	}else{
		document.getElementById("primaryDiagnosisError").innerHTML = "";
	}
	
	if(icdCode==""){
		document.getElementById("picdCodeError").innerHTML = "Please Select ICD Code";
		 document.getElementById("pidcCodee").focus();
        return false;
	}else{
		document.getElementById("picdCodeError").innerHTML = "";
	}
	
		onRegister();
		$.ajax({
        type: "POST",
        url: ""+$('#ctx').attr('content')+"/catchPrimaryDiagnosis",
        data: {
		  "txnid":txnid,
		  "icdCode": icdCode,
          "icdDesc": primaryDiagnosis
        },
        success: function (data) {
			offRegister()
			newData = data;
        	//var data1 = jQuery.parseJSON( newData );
			var data2 = newData.data;
	        if (newData.message == "SUCCESS") {
				$("#primarydaignoseData").dataTable().fnClearTable();
				$("#primarydaignoseData").dataTable().fnDraw();
				$("#primarydaignoseData").dataTable().fnDestroy();
		        $('#primarydaignoseData').DataTable( {	
			     "responsive": true, "lengthChange": true, "autoWidth": false,"paging": false, "searching": false,"lengthMenu": false,
		         "language": {"emptyTable": "No Data available"  },
		         "searching": false, info: false,
		         "aaData": data2,
		  		  "aoColumns": [ 
			  		    { "mData": "icdDesc"},          
			  		    { "mData": "icdCode"},
			  		    {
							"mData": function(data2, type, row) {
								return '<button type="button" value="' + data2.txnid + '^^' + data2.tempId + '"  onclick="deleteDaignoseData(this.value)" class="btn btn-sm btn-primary btn-floting" style="border-radius: 50%;" data-toggle="modal" data-keyboard="false" data-backdrop="static" data-target="#modal-revoke" style="background: #2c2d6e;"><i class="fa fa-minus"></i></button>';
							}
						}
				 	]
		  		})
		 		document.getElementById("primaryDiagnosis").value="";
				document.getElementById("pidcCodee").value = ""; 
	        }else if(newData.message=="FAILURE"){
				document.getElementById("pdiagnosisfailmsg").innerHTML=newData.message;
				document.getElementById("pdiagnosisFailmsgDiv").style.display="block";
			}else {
	        	alert('API Gateway not respond. Please try again.');
	        }
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }
      });
}

function secondaryPreAuthDiagnose(){
	var txnid = document.getElementById("txnid").value;
	var secondaryDiagnosis = document.getElementById("secondaryDiagnosis").value;	
	var icdCode = document.getElementById("idcCodee").value;
	
	if(secondaryDiagnosis==""){
		document.getElementById("secondaryDiagnosisError").innerHTML = "Please Enter Secondary Diagnosis.";
		 document.getElementById("secondaryDiagnosis").focus();
        return false;
	}else{
		document.getElementById("secondaryDiagnosisError").innerHTML = "";
	}
	
	if(icdCode==""){
		document.getElementById("icdCodeError").innerHTML = "Please Select ICD Code";
		 document.getElementById("idcCodee").focus();
        return false;
	}else{
		document.getElementById("icdCodeError").innerHTML = "";
	}
	
		onRegister();
		$.ajax({
        type: "POST",
        url: ""+$('#ctx').attr('content')+"/catchSecondaryDiagnosis",
        data: {
		  "txnid":txnid,
		  "icdCode": icdCode,
          "icdDesc": secondaryDiagnosis
        },
        success: function (data) {
			offRegister()
			newData = data;
			var data2 = newData.data;
	        if (newData.message == "SUCCESS") {
				$("#secondarydaignoseData").dataTable().fnClearTable();
				$("#secondarydaignoseData").dataTable().fnDraw();
				$("#secondarydaignoseData").dataTable().fnDestroy();
		        $('#secondarydaignoseData').DataTable( {	
			     "responsive": true, "lengthChange": true, "autoWidth": false,"paging": false, "searching": false,"lengthMenu": false,
		         "language": {"emptyTable": "No Data available"  },
		         "searching": false, info: false,
		         "aaData": data2,
		  		  "aoColumns": [ 
			  		    { "mData": "icdDesc"},          
			  		    { "mData": "icdCode"},			  		    {
							"mData": function(data2, type, row) {
								return '<button type="button" value="' + data2.txnid + '^^' + data2.tempId + '"  onclick="deleteSecondaryDaignoseData(this.value)" class="btn btn-sm btn-primary btn-floting" style="border-radius: 50%;" data-toggle="modal" data-keyboard="false" data-backdrop="static" data-target="#modal-revoke" style="background: #2c2d6e;"><i class="fa fa-minus"></i></button>';
							}
						}
				 	]
		  		})
				document.getElementById("secondaryDiagnosis").value = "";
				document.getElementById("idcCodee").value = ""; 
	        }else if(newData.message=="FAILURE"){
				document.getElementById("sdiagnosisfailmsg").innerHTML=newData.message;
				document.getElementById("sdiagnosisFailmsgDiv").style.display="block";
			}else {
	        	alert('API Gateway not respond. Please try again.');
	        }
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }
      });
}


function getDaignoseData(txnid) {
	$.ajax({
		type: "POST",
		url: "" + $('#ctx').attr('content') + "/getPrimaryDaignoseData",
		data: {
			"txnid": txnid
		},
		success: function(data) {
			newData = data;
			var data2 = newData.data;
			if (data2.length!=0 && newData.message == "SUCCESS") {
				$("#primarydaignoseData").dataTable().fnClearTable();
				$("#primarydaignoseData").dataTable().fnDraw();
				$("#primarydaignoseData").dataTable().fnDestroy();
		        $('#primarydaignoseData').DataTable( {	
			     "responsive": true, "lengthChange": true, "autoWidth": false,"paging": false, "searching": false,"lengthMenu": false,
		         "language": {"emptyTable": "No Data available"  },
		         "searching": false, info: false,
		         "aaData": data2,
		  		  "aoColumns": [ 
			  		    { "mData": "icdDesc"},          
			  		    { "mData": "icdCode"},
			  		    {
							"mData": function(data2, type, row) {
								return '<button type="button" value="' + data2.txnid + '^^' + data2.tempId + '"  onclick="deleteDaignoseData(this.value)" class="btn btn-sm btn-primary btn-floting" style="border-radius: 50%;" data-toggle="modal" data-keyboard="false" data-backdrop="static" data-target="#modal-revoke" style="background: #2c2d6e;"><i class="fa fa-minus"></i></button>';
							}
						}
				 	]
		  		})				
			}else if(newData.message == "FAILURE"){
				alert('Api not Responding, Please try Again Later..!');	
			}
		},
		error: function() {
			alert('Api not Responding, Please try Again Later..!');
		}
	});	
}

function getSecondaryDaignoseData(txnid) {
	$.ajax({
		type: "POST",
		url: "" + $('#ctx').attr('content') + "/getSecondaryDaignoseData",
		data: {
			"txnid": txnid
		},
		success: function(data) {
			newData = data;
			var data2 = newData.data;
			if (data2.length!=0 && newData.message == "SUCCESS") {
				$("#secondarydaignoseData").dataTable().fnClearTable();
				$("#secondarydaignoseData").dataTable().fnDraw();
				$("#secondarydaignoseData").dataTable().fnDestroy();
		        $('#secondarydaignoseData').DataTable( {	
			     "responsive": true, "lengthChange": true, "autoWidth": false,"paging": false, "searching": false,"lengthMenu": false,
		         "language": {"emptyTable": "No Data available"  },
		         "searching": false, info: false,
		         "aaData": data2,
		  		  "aoColumns": [ 
			  		    { "mData": "icdDesc"},          
			  		    { "mData": "icdCode"},
			  		    {
							"mData": function(data2, type, row) {
								return '<button type="button" value="' + data2.txnid + '^^' + data2.tempId + '"  onclick="deleteSecondaryDaignoseData(this.value)" class="btn btn-sm btn-primary btn-floting" style="border-radius: 50%;" data-toggle="modal" data-keyboard="false" data-backdrop="static" data-target="#modal-revoke" style="background: #2c2d6e;"><i class="fa fa-minus"></i></button>';
							}
						}
				 	]
		  		})				
			}else if(newData.message == "FAILURE"){
				alert('Api not Responding, Please try Again Later..!');	
			}
		},
		error: function() {
			alert('Api not Responding, Please try Again Later..!');
		}
	});	
}

function deleteDaignoseData(deleteDaignoseData) {
	const myArray = deleteDaignoseData.split("^^");
	var txnid = myArray[0];
	var tempId = myArray[1];
	$.ajax({
		type: "POST",
		url: "" + $('#ctx').attr('content') + "/deletePrimaryDaignoseData",
		data: {
			"txnid": txnid,
			"tempId": tempId,
		},
		success: function(data) {
			newData = data;
			if (newData == "SUCCESS") {
				$("#primarydaignoseData").dataTable().fnClearTable();
				$("#primarydaignoseData").dataTable().fnDraw();
				$("#primarydaignoseData").dataTable().fnDestroy();
				window.setTimeout(function(){getDaignoseData(txnid)},100);
			}else {
	        	alert('API Gateway not respond. Please try again.');
	        }
		},
		error: function() {
			alert('Api not Responding, Please try Again Later..!');
		}
	});
}

function deleteSecondaryDaignoseData(deleteDaignoseData) {
	const myArray = deleteDaignoseData.split("^^");
	var txnid = myArray[0];
	var tempId = myArray[1];
	$.ajax({
		type: "POST",
		url: "" + $('#ctx').attr('content') + "/deleteSecondaryDaignoseData",
		data: {
			"txnid": txnid,
			"tempId": tempId,
		},
		success: function(data) {
			newData = data;
			if (newData == "SUCCESS") {
				$("#secondarydaignoseData").dataTable().fnClearTable();
				$("#secondarydaignoseData").dataTable().fnDraw();
				$("#secondarydaignoseData").dataTable().fnDestroy();
				window.setTimeout(function(){getSecondaryDaignoseData(txnid)},100);
			}else {
	        	alert('API Gateway not respond. Please try again.');
	        }
		},
		error: function() {
			alert('Api not Responding, Please try Again Later..!');
		}
	});
}


function getCatchStratificationData(txnid) {
	$.ajax({
		type: "POST",
		url: "" + $('#ctx').attr('content') + "/getCatchStratificationData",
		data: {
			"txnid": txnid
		},
		success: function(data) {
			newData = data;
			var data2 = newData.data;
			console.log("txnid"+data2)
			if (data2.length!=0 && newData.message == "SUCCESS") {
				$("#stratificationData").dataTable().fnClearTable();
				$("#stratificationData").dataTable().fnDraw();
				$("#stratificationData").dataTable().fnDestroy();
		        $('#stratificationData').DataTable( {	
			     "responsive": true, "lengthChange": true, "autoWidth": false,"paging": false, "searching": false,"lengthMenu": false,
		         "language": {"emptyTable": "No Data available"  },
		         "searching": false, info: false,
		         "aaData": data2,
		  		  "aoColumns": [ 
			  		    { "mData": "stratCode"},          
			  		    { "mData": "stratDtls"},
			  		    { "mData": "stratName"},
			  		    { "mData": "stratCost"},
			  		    { "mData": "totalStratCost"},
			  		    { "mData": "noOfUnits"},
			  		    {
							"mData": function(data2, type, row) {
								return '<button type="button" value="' + data.txnid + '^^' + data2.tempId + '"  onclick="deleteCatchStratificationData(this.value)" class="btn btn-sm btn-primary btn-floting" style="border-radius: 50%;" data-toggle="modal" data-keyboard="false" data-backdrop="static" data-target="#modal-revoke" style="background: #2c2d6e;"><i class="fa fa-minus"></i></button>';
							}
						}
				 	]
		  		})				
			}else if(newData.message == "FAILURE"){
				alert('Api not Responding, Please try Again Later..!');	
			}
		},
		error: function() {
			alert('Api not Responding, Please try Again Later..!');
		}
	});	
}

function deleteCatchStratificationData(deleteDaignoseData) {
	const myArray = deleteDaignoseData.split("^^");
	var txnid = myArray[0];
	var tempId = myArray[1];
	$.ajax({
		type: "POST",
		url: "" + $('#ctx').attr('content') + "/deleteCatchStratificationData",
		data: {
			"txnid": txnid,
			"tempId": tempId,
		},
		success: function(data) {
			newData = data;
			if (newData == "SUCCESS") {
				$("#stratificationData").dataTable().fnClearTable();
				$("#stratificationData").dataTable().fnDraw();
				$("#stratificationData").dataTable().fnDestroy();
				window.setTimeout(function(){getCatchStratificationData(txnid)},100);
			}else {
	        	alert('API Gateway not respond. Please try again.');
	        }
		},
		error: function() {
			alert('Api not Responding, Please try Again Later..!');
		}
	});
}




function preAuthTreatmentProtocal(){
	
	var txnid = document.getElementById("txnid").value;
	var patientId = document.getElementById("patientId").value;
	var procedureid = document.getElementById("procedureid").value;
	var speciality = document.getElementById("speciality").value;
	var packageid = document.getElementById("packageid").value;
	var ichiCode = document.getElementById("ichiCode").value;
	var investigationActive =  $('#investigationActive option:selected').toArray().map(item => item.value).join();
	var presentIllnesHistory = document.getElementById("presentIllnesHistory").value;
	
	var iCode = document.getElementById("ichiCode");
	var ichiCodetxt = iCode.options[iCode.selectedIndex].text;

	var procid = document.getElementById("procedureid");
	var procedureidText = procid.options[procid.selectedIndex].text;
	
	var spec = document.getElementById("speciality");
	var specialityText = spec.options[spec.selectedIndex].text;
	
	var pckgid = document.getElementById("packageid");
	var packageidText = pckgid.options[pckgid.selectedIndex].text;
	
	var investigationActivetxt =  $('#investigationActive option:selected').toArray().map(item => item.text).join();
	 
	if(speciality==""){
		document.getElementById("specialityError").innerHTML = "Please Select Specility";
		 document.getElementById("speciality").focus();
        return false;
	}else{
		document.getElementById("specialityError").innerHTML = "";
	}
	
	if(packageid==""){
		document.getElementById("packageidError").innerHTML = "Please Select Package";
		 document.getElementById("packageid").focus();
        return false;
	}else{
		document.getElementById("packageidError").innerHTML = "";
	}
	
	if(procedureid==""){
		document.getElementById("procedureidError").innerHTML = "Please Select Procedure";
		 document.getElementById("procedureid").focus();
        return false;
	}else{
		document.getElementById("procedureidError").innerHTML = "";
	}
	
	if(ichiCode==""){
		document.getElementById("ichiCodeError").innerHTML = "Please Select ICHI Code";
		 document.getElementById("ichiCode").focus();
        return false;
	}else{
		document.getElementById("ichiCodeError").innerHTML = "";
	}
		onRegister();
		$.ajax({
        type: "POST",
        url: ""+$('#ctx').attr('content')+"/catchPreAuthTreatmentProtocal",
      
        data: {
		  "txnid":txnid,
          "procedureid": procedureid,
          "speciality": speciality,
          "ichiCode": ichiCode,
          "packageid": packageid,
          "investigationActive": investigationActive,   
          "presentIllnesHistory":presentIllnesHistory,  
          "specialitytxt":specialityText,
		  "packageidtxt":packageidText,
		  "ichiCodetxt":ichiCodetxt,
	 	  "procedureidtxt":procedureidText,
	 	  "investigationActivetxt":investigationActivetxt
	 	  
        },
        success: function (data) {
		offRegister()
        newData = data;
        var data2 = newData.data;
	    if (newData.message == "SUCCESS") {	
	 		$("#treatMentProtocalTable").dataTable().fnClearTable();
			$("#treatMentProtocalTable").dataTable().fnDraw();
			$("#treatMentProtocalTable").dataTable().fnDestroy();
	        $('#treatMentProtocalTable').DataTable( {	
		     "responsive": true, "lengthChange": true, "autoWidth": false,"paging": false, "searching": false,"lengthMenu": false,
	         "language": {"emptyTable": "No Data available"  },
	         "searching": false, info: false,
	         "aaData": data2,
	  		  "aoColumns": [ 
		  		    { "mData": "specialitytxt"},          
		  		    { "mData": "packageidtxt"},
		  		    { "mData": "procedureidtxt"},
		  		    { "mData": "ichiCodetxt"},
		  		    { "mData": "investigationActivetxt"},
		  		    
		  		    { "mData": "stratificationstatus"},
		  		    { "mData": "implantstatus"},
		  		    { "mData": "erupistatus"},
		  		    {
						"mData": function(data2, type, row) {
							return '<button type="button" value="' + data2.txnid + '^^' + data2.tempId + '"  onclick="deleteprotoColData(this.value)" class="btn btn-sm btn-primary btn-floting" style="border-radius: 50%;" data-toggle="modal" data-keyboard="false" data-backdrop="static" data-target="#modal-revoke" style="background: #2c2d6e;"><i class="fa fa-minus"></i></button>';
						}
						
					},
					{ "mData": "presentIllnesHistory"},
			 	]
	  		})
	  		
			 document.getElementById("procedureView").innerHTML=$("#procedureid option:selected").text();
			 document.getElementById("specialityView").innerHTML=$("#speciality option:selected").text();
			 document.getElementById("ichiCodeView").innerHTML=$("#ichiCode option:selected").text();
			 document.getElementById("invetgationView").innerHTML=primaryDiagnosis;
			 document.getElementById("historyView").innerHTML=presentIllnesHistory;
			 
			 document.getElementById("speciality").value="";
			 document.getElementById("packageid").value="";
			 document.getElementById("procedureid").value="";
			 document.getElementById("ichiCode").value="";
			 document.getElementById("investigationActive").value="";
			 document.getElementById("presentIllnesHistory").innerHTML="";
			 getProcedureForStratification();
			 getProcedureForImplant();
			 getProcedureForErupi();
			 getPackageCost(txnid);
          }else if(newData.message=="FAILURE"){
				 document.getElementById("tfailmsg").innerHTML=data1.message;
				 document.getElementById("tfailmsgDiv").style.display="block";
		  }else{
            alert('API Gateway not respond. Please try again.');
          }
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }

      });
}

//////////////////////////////////

function getProcedureForStratification() {
		
		var txnid = document.getElementById("txnid").value;
	
  		$.ajax({
		 type: "POST",
		 url:""+$('#ctx').attr('content')+"/getProcedureForStratification",
         data: { 
				"txnid":txnid,
       		 },
       		
           success: function(data){
            newData = data;
            console.log(newData);
			$("#stratProcCode option").remove();
            // console.log("-------"+obj);
            var count=0;
            var x = document.getElementById("stratProcCode");
            
            for(let i = 0; i < newData.data.length; i++){ 
				var childArray = newData.data[i].procedureidtxt; 
				var childArray2 = newData.data[i].procedureid;
				 if(count==0){
		             var option = document.createElement("option");
		             option.text ="Select Procedure";
		             option.value = "";
		             x.add(option);
             	}
             	
	         	 var option = document.createElement("option");
	             option.text = childArray;
	             option.value = childArray2;
	             x.add(option);
	             count++;
			}
         },
         error: function(e){
             alert('Error: ' + e);
         }
    });
 } 

function getProcedureForImplant() {
		
		var txnid = document.getElementById("txnid").value;
	
  		$.ajax({
		 type: "POST",
		 url:""+$('#ctx').attr('content')+"/getProcedureForImplant",
         data: { 
				"txnid":txnid,
       		 },
       		
          success: function(data){
            newData = data;
            console.log(newData);
			$("#implantProcCode option").remove();
            var count=0;
            var x = document.getElementById("implantProcCode");
            
            for(let i = 0; i < newData.data.length; i++){ 
				var childArray = newData.data[i].procedureidtxt; 
				var childArray2 = newData.data[i].procedureid;
				 if(count==0){
		             var option = document.createElement("option");
		             option.text ="Select Procedure";
		             option.value = "";
		             x.add(option);
             	}
             	
	         	 var option = document.createElement("option");
	             option.text = childArray;
	             option.value = childArray2;
	             x.add(option);
	             count++;
			}
         },
         error: function(e){
             alert('Error: ' + e);
         }
    });
 } 
 
 function getProcedureForErupi() {
		
		var txnid = document.getElementById("txnid").value;
	
  		$.ajax({
		 type: "POST",
		 url:""+$('#ctx').attr('content')+"/getProcedureForErupi",
         data: { 
				"txnid":txnid,
       		 },
       		
          success: function(data){
            newData = data;
            console.log(newData);
			$("#erupiProcName option").remove();
            var count=0;
            var x = document.getElementById("erupiProcName");
            
            for(let i = 0; i < newData.data.length; i++){ 
				var childArray = newData.data[i].procedureidtxt; 
				var childArray2 = newData.data[i].procedureid;
				 if(count==0){
		             var option = document.createElement("option");
		             option.text ="Select Procedure";
		             option.value = "";
		             x.add(option);
             	}
             	
	         	 var option = document.createElement("option");
	             option.text = childArray;
	             option.value = childArray2;
	             x.add(option);
	             count++;
			}
         },
         error: function(e){
             alert('Error: ' + e);
         }
    });
 } 
 
//////////////////////////////


function getprotoColData(txnid) {
	$.ajax({
		type: "POST",
		url: "" + $('#ctx').attr('content') + "/getprotoColData",
		data: {
			"txnid": txnid
		},
		success: function(data) {
			newData = data;
			var data2 = newData.data;
			if (data2.length!=0 && newData.message == "SUCCESS") {
				$("#treatMentProtocalTable").dataTable().fnClearTable();
				$("#treatMentProtocalTable").dataTable().fnDraw();
				$("#treatMentProtocalTable").dataTable().fnDestroy();
		        $('#treatMentProtocalTable').DataTable( {	
			     "responsive": true, "lengthChange": true, "autoWidth": false,"paging": false, "searching": false,"lengthMenu": false,
		         "language": {"emptyTable": "No Data available"  },
		         "searching": false, info: false,
		         "aaData": data2,
		  		  "aoColumns": [ 
					{ "mData": "specialitytxt"},          
		  		    { "mData": "packageidtxt"},
		  		    { "mData": "procedureidtxt"},
		  		    { "mData": "ichiCodetxt"},
		  		    { "mData": "investigationActivetxt"},
		  		   
		  		    { "mData": "stratificationstatus"},
		  		    { "mData": "implantstatus"},
		  		     { "mData": "erupistatus"},
			  		    {
							"mData": function(data2, type, row) {
								return '<button type="button" value="' + data2.txnid + '^^' + data2.tempId + '"  onclick="deleteprotoColData(this.value)" class="btn btn-sm btn-primary btn-floting" style="border-radius: 50%;" data-toggle="modal" data-keyboard="false" data-backdrop="static" data-target="#modal-revoke" style="background: #2c2d6e;"><i class="fa fa-minus"></i></button>';
							}
						},
						 { "mData": "presentIllnesHistory"},
				 	]
		  		})				
			}else if(newData.message == "FAILURE"){
				alert('Api not Responding, Please try Again Later..!');	
			}
		},
		error: function() {
			alert('Api not Responding, Please try Again Later..!');
		}
	});	
}

function deleteprotoColData(deleteprotoColData) {
	const myArray = deleteprotoColData.split("^^");
	var txnid = myArray[0];
	var tempId = myArray[1];
	$.ajax({
		type: "POST",
		url: "" + $('#ctx').attr('content') + "/deleteprotoColData",
		data: {
			"txnid": txnid,
			"tempId": tempId,
		},
		success: function(data) {
			newData = data;
			if (newData == "SUCCESS") {
				$("#daignoseData").dataTable().fnClearTable();
				$("#daignoseData").dataTable().fnDraw();
				$("#daignoseData").dataTable().fnDestroy();
				window.setTimeout(function(){getprotoColData(txnid)},100);
			}else {
	        	alert('API Gateway not respond. Please try again.');
	        }
		},
		error: function() {
			alert('Api not Responding, Please try Again Later..!');
		}
	});
}


function preAuthExamination(){
	var txnid = document.getElementById("txnid").value;
	var tempretureRadio = document.getElementById("c").checked;
	var temperature = document.getElementById("temperature").value;
	var temperatureParameter;
	
	var option=document.getElementsByName('temperatureParameter');
     
	if (!(option[0].checked || option[1].checked)) {
	    //alert("Please Select Temperature");
	    document.getElementById("examinationError").innerHTML="Please Select Temperature";
	    document.getElementById("c").focus();
	    return false;
	}
	if(temperature =="" || temperature==null){
		//alert("Please Enter Temperature");
		document.getElementById("examinationError").innerHTML="Please Enter Temperature";
		document.getElementById("temperature").focus();
	    return false;
	}
	if(tempretureRadio ==true)
	{
		temperatureParameter="C";
		document.getElementById("tempretureViewC").innerHTML = "C";
	}
	else {
		temperatureParameter = "F";
		document.getElementById("tempretureViewC").innerHTML = "F";
	}
	var pluseRate = document.getElementById("pluseRate").value;
	var bpLt = document.getElementById("bpLt").value;
	var bpht = document.getElementById("bpht").value;
	var bpRt = document.getElementById("bpRt").value;
	var bpRth = document.getElementById("bpRth").value;
	var height = document.getElementById("height").value;
	var weight = document.getElementById("weight").value;
	var bmi = document.getElementById("bmi").value;
	var pallorradio = document.getElementById("pallor1").checked;
	
	if(pluseRate==""){
		document.getElementById("examinationError").innerHTML="Please Enter Pulse Rate";
		document.getElementById("pluseRate").focus();
	    return false;
	}
	if(bpLt ==""){
		document.getElementById("examinationError").innerHTML="Please Enter BP Lt.Arm";
		document.getElementById("bpLt").focus();
	    return false;
	}
	if(bpht ==""){
		document.getElementById("examinationError").innerHTML="Please Enter BP Lt.Arm";
		document.getElementById("bpht").focus();
	    return false;
	}
	if(bpRt ==""){
		document.getElementById("examinationError").innerHTML="Please Enter BP Rt.Arm";
		document.getElementById("bpRt").focus();
	    return false;
	}
	if(bpRth ==""){
		document.getElementById("examinationError").innerHTML="Please Enter BP Rt.Arm";
		document.getElementById("bpRth").focus();
	    return false;
	}
	else{
		document.getElementById("examinationError").innerHTML="";
	}
	
	var pallor;
	if(pallorradio == true)
	{
		pallor="Y";
		document.getElementById("pallorVIew").innerHTML="Y";
	}
	else {
		pallor = "N";
		document.getElementById("pallorVIew").innerHTML="N";
	}
	
	var cyanosisradio = document.getElementById("cyanosis1").checked;
	var cyanosis;
	if(cyanosisradio == true)
	{
		cyanosis="Y";
		document.getElementById("cyanosisView").innerHTML="Y";
	}
	else{
		cyanosis="N";
		document.getElementById("cyanosisView").innerHTML="N";
	}
	var clubOfFingertoes;
	if(document.getElementById("cyanosis1").checked){
		clubOfFingertoes="Y";
		document.getElementById("clubbingView").innerHTML="Y";
	}
	else{
		clubOfFingertoes="N";
		document.getElementById("clubbingView").innerHTML="N";
		
	}
	var lymphadenopathy;
	if(document.getElementById("lymphadenopathy1").checked){
		lymphadenopathy="Y";
		document.getElementById("lymphadenopathyView").innerHTML="Y";
	}
	else{
		lymphadenopathy="N";
		document.getElementById("lymphadenopathyView").innerHTML="N";
	}
	var oedemaInFeet;
	if(document.getElementById("oedemaInFeet1").checked){
		oedemaInFeet="Y";
		document.getElementById("oedemaView").innerHTML="Y";
	}
	else{
		oedemaInFeet="N";
		document.getElementById("oedemaView").innerHTML="N";
	}
	var malnutrition;
	if(document.getElementById("malnutrition1").checked){
		malnutrition="Y";
		document.getElementById("malnutritionView").innerHTML="Y";
		
	}
	else{
		malnutrition="N";
		document.getElementById("malnutritionView").innerHTML="N";
	}
	var dehydration;
	if(document.getElementById("dehydration1").checked){
		document.getElementById("dehydrationView").innerHTML="Y";
		dehydration="Y";
		
	}
	else{
		dehydration="N";
		document.getElementById("dehydrationView").innerHTML="N";
	}
	var respirationRate = document.getElementById("respirationRate").value;
	onRegister();
	$.ajax({
        type: "POST",
        url: ""+$('#ctx').attr('content')+"/catchPreAuthData",
      
        data: {
	       "txnid": txnid,
          "temperatureParameter": temperatureParameter,
          "temperature":temperature,
          "pluseRate": pluseRate,
          "bpLt": bpLt,
          "bpht": bpht,
          "bpRt": bpRt,
          "bpRth": bpRth,
          "height": height,
          "weight": weight,
          "bmi": bmi,
          "pallor": pallor,
          "cyanosis": cyanosis,
          "clubOfFingertoes": clubOfFingertoes,
          "lymphadenopathy": lymphadenopathy,
          "oedemaInFeet": oedemaInFeet,
          "malnutrition": malnutrition,
          "dehydration": dehydration,
          "respirationRate":respirationRate,
          
        },
        success: function (data) {
          offRegister();
          if (data == "SUCCESS") {
	 		 document.getElementById("succmsg").innerHTML="Data Saved ";
			 document.getElementById("succmsgdiv").style.display="block";
			 //$('#succmsgdiv').delay(5000).fadeOut(400);
			 
			 document.getElementById("tempretureView").innerHTML = $("#temperature").val();
			 document.getElementById("tempretureView").innerHTML = $("#pluseRate").val();
			 document.getElementById("bprtViewh").innerHTML = $("#bpLt").val();
			 document.getElementById("bprtViewl").innerHTML = $("#bpht").val();
			 document.getElementById("btltl").innerHTML = $("#bpRt").val();
			 document.getElementById("btltH").innerHTML = $("#bpRth").val();
			 document.getElementById("heightView").innerHTML = $("#height").val();
			 //document.getElementById("tempretureView").innerHTML = $("#weight").val();
			 document.getElementById("bmiView").innerHTML = $("#bmi").val();
			 document.getElementById("respirationView").innerHTML = $("#respirationRate").val();
			 document.getElementById("pulseView").innerHTML = $("#pluseRate").val();
			 
          }
           else if(data=="FAILURE"){
				 document.getElementById("failmsg").innerHTML=data1.message;
				 document.getElementById("failmsgDiv").style.display="block";
				// $('#failmsgDiv').delay(5000).fadeOut(400);
				 //window.location.reload();
			}
           else {
            alert('API Gateway not respond. Please try again.');
          }
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }

      });
}

 function preAuthPersonalHistory(){
	var txnid = document.getElementById("txnid").value;
    var appetite = document.getElementById("appetite").value;
	var diet = document.getElementById("diet").value;
	var bowels = document.getElementById("bowels").value;
	var nutrition = document.getElementById("nutrition").value;
	
	if(appetite==""){
		document.getElementById("personalHistoryError").innerHTML="Please Select Apptite";
		document.getElementById("appetite").focus();
	    return false;
	}
	if(diet==""){
		document.getElementById("personalHistoryError").innerHTML="Please Select Diet";
		document.getElementById("diet").focus();
	    return false;
	}
	if(bowels==""){
		document.getElementById("personalHistoryError").innerHTML="Please Select Bowels";
		document.getElementById("bowels").focus();
	    return false;
	}
	if(nutrition==""){
		document.getElementById("personalHistoryError").innerHTML="Please Select Nutrition";
		document.getElementById("nutrition").focus();
	    return false;
	}
	
	var option=document.getElementsByName('knownAllergies');
     
	if (!(option[0].checked || option[1].checked)) {
	    document.getElementById("personalHistoryError").innerHTML="Please Checked knownAllergies";
		document.getElementById("knownAllergies").focus();
	    return false;
	}
	
	var option=document.getElementsByName('habit');
     
	if (!(option[0].checked || option[1].checked)) {
		document.getElementById("personalHistoryError").innerHTML="Please Checked Habit";
		document.getElementById("habit").focus();
	    return false;
	}
	
	var habit;
	var addictions= "Y";
	var alergictomed="Y";
	var alergictomeddesc="Allergy";
	var alertosub= "Y";
	var alerttosubdesc= "Allergy2";
	var alcohol= "Regular";
	var druguse= "Y";
	var beetelnut= "Y";
	var betelleaf= "Y";
	var pack= "2";
	var years="6";
	var tobacco= "Smoking";
	
	if( document.getElementById("habit1").checked){
		habit="Y";
		document.getElementById("habitsView").innerHTML="Y";
	}
	else{
		habit="N";
		document.getElementById("habitsView").innerHTML="N";
	}
	var knownAllergies;
	if( document.getElementById("knownAllergies1").checked){
		knownAllergies="Y";
		document.getElementById("knowView").innerHTML="Y";
	}
	else{
		knownAllergies="N";
		document.getElementById("knowView").innerHTML="N";
	}
		onRegister();
		$.ajax({
        type: "POST",
        url: ""+$('#ctx').attr('content')+"/catchPreAuthPersonalHistory",
      
        data: {
		  "txnid" :txnid,
          "appetite": appetite,
          "diet": diet,
          "bowels": bowels,
          "nutrition": nutrition,
          "knownAllergies": knownAllergies,
          "addictions": addictions,   
          "alergictomed":alergictomed,
           "alergictomeddesc":alergictomeddesc,
           "alertosub":alertosub,
           "alerttosubdesc":alerttosubdesc,
           "alcohol":alcohol,
           "druguse":druguse,
           "beetelnut":beetelnut,
           "betelleaf":betelleaf,
           "pack":pack,
           "years":years,
           "tobacco":tobacco,
           
        },
        success: function (data) {
			 offRegister();
             if (data == "SUCCESS") {
	 		 document.getElementById("historysuccmsg").innerHTML="Data  Saved";
			 document.getElementById("historysuccmsgdiv").style.display="block";
			// $('#succmsgdiv').delay(5000).fadeOut(400);
			
			 document.getElementById("appetiteView").innerHTML=$("#appetite option:selected").text();
			 document.getElementById("dietView").innerHTML=$("#diet option:selected").text();
			 document.getElementById("bowelsView").innerHTML=$("#bowels option:selected").text();
			
			 document.getElementById("nutritionVIew").innerHTML=$("#nutrition option:selected").text();
			 //document.getElementById("knowView").innerHTML=$("#nutrition option:selected").text();
			 //document.getElementById("habitsView").innerHTML=$("#invetgationView option:selected").text();
			
          }
           else if(data=="FAILURE"){
				 document.getElementById("historyfailmsg").innerHTML=data1.message;
				 document.getElementById("historyfailmsgDiv").style.display="block";
			}
           else {
            alert('API Gateway not respond. Please try again.');
          }
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }

      });
}

function preAuthPastFamilyHistory(){
		var txnid = document.getElementById("txnid").value;
		var PH12; var PH1;var PH2; var PH3; var PH4; var PH5;var PH7;var PH8; var PH9; var PH10; var PH11; var PH13;
	    var FH1; var FH2; var FH3; var FH4; var FH5; var FH6; var FH7; var FH8; var FH9; var FH11; var FH12;
		if(document.getElementById("PH12").checked){
		PH12 = "PH12";
		document.getElementById("eEndocrineView").style.display="block";
		}
		else{
			PH12 = "";
			document.getElementById("eEndocrineView2").style.display="block";
		}
		if(document.getElementById("PH1").checked){
		PH1 = "PH1";
		document.getElementById("pDiabetesView").style.display="block";
		}
		else{
			PH1 = "";
			document.getElementById("pDiabetesView").style.display="block";
		}
		if(document.getElementById("PH2").checked){
		PH2 = "PH2";
		document.getElementById("pHypertensionView").style.display="block";
		}
		else{
			PH2 = "";
			document.getElementById("pHypertensionView").style.display="block";
		}
		if(document.getElementById("PH3").checked){
		PH3 = "PH3";
		document.getElementById("pCADView").style.display="block";
		}
		else{
			PH3 = "";
			document.getElementById("pCADView").style.display="block";
		}
		if(document.getElementById("PH4").checked){
		PH4 = "PH4";
		document.getElementById("pAsthmaView").style.display="block";
		}
		else{
			PH4 = "";
			document.getElementById("pAsthmaView").style.display="block";
		}
		if(document.getElementById("PH5").checked){
		PH5 = "PH5";
		document.getElementById("pTuberculosisView").style.display="block";
		}
		else{
			PH5 = "";
			document.getElementById("pTuberculosisView").style.display="block";
		}
		if(document.getElementById("PH7").checked){
		PH7 = "PH7";
		document.getElementById("pStrokeView").style.display="block";
		}
		else{
			PH7 = "";
			document.getElementById("pStrokeView").style.display="block";
		}
		if(document.getElementById("PH8").checked){
		PH8 = "PH8";
		document.getElementById("pCancersView").style.display="block";
		}
		else{
			PH8 = "";
			document.getElementById("pCancersView").style.display="block";
		}
		if(document.getElementById("PH9").checked){
		PH9 = "PH9";
		document.getElementById("pbloodView").style.display="block";
		}
		else{
			PH9 = "";
			document.getElementById("pbloodView").style.display="block";
		}
		
		if(document.getElementById("PH10").checked){
		PH10 = "PH10";
		document.getElementById("purgeriesView").style.display="block";
		}
		else{
			PH10 = "";
			document.getElementById("purgeriesView").style.display="block";
		}
		if(document.getElementById("PH11").checked){
		PH11 = "PH11";
		//document.getElementById("eEndocrineView").style.display="block";
		}
		else{
			PH11 = "";
		//	document.getElementById("eEndocrineView").style.display="block";
		}
		if(document.getElementById("PH13").checked){
		PH13 = "PH13";
		//document.getElementById("eEndocrineView").style.display="block";
		}
		else{
			PH13 = "";
			//document.getElementById("eEndocrineView").style.display="block";
		}
		
		
		
		if(document.getElementById("FH1").checked){
		FH1 = "FH1";
		document.getElementById("fdiabetesView").style.display="block";
		}
		else{
			FH1 = "";
			document.getElementById("fdiabetesView").style.display="block";
		}
		if(document.getElementById("FH2").checked){
		FH2 = "FH2";
		document.getElementById("fhipertensionView").style.display="block";
		}
		else{
			FH2 = "";
			document.getElementById("fhipertensionView").style.display="block";
		}
		if(document.getElementById("FH3").checked){
		FH3 = "FH3";
		document.getElementById("fheartView").style.display="block";
		}
		else{
			FH3 = "";
			document.getElementById("fheartView").style.display="block";
		}
		if(document.getElementById("FH4").checked){
		FH4 = "FH4";
		document.getElementById("fStrikeView").style.display="block";
		}
		else{
			FH4 = "";
			document.getElementById("fStrikeView").style.display="block";
		}
		if(document.getElementById("FH5").checked){
		FH5 = "FH5";
		document.getElementById("fcancersView").style.display="block";
		}
		else{
			FH5 = "";
			document.getElementById("fcancersView").style.display="block";
		}
		if(document.getElementById("FH6").checked){
		FH6 = "FH6";
		document.getElementById("ftuberculosisView").style.display="block";
		}
		else{
			FH6 = "";
			document.getElementById("ftuberculosisView").style.display="block";
		}
		if(document.getElementById("FH7").checked){
		FH7 = "FH7";
		document.getElementById("fasthmaView").style.display="block";
		}
		else{
			FH7 = "";
			document.getElementById("fasthmaView").style.display="block";
		}
		if(document.getElementById("FH8").checked){
		FH8 = "FH8";
		document.getElementById("fanyotherView").style.display="block";
		}
		else{
			FH8 = "";
			document.getElementById("fanyotherView").style.display="block";
		}
		if(document.getElementById("FH9").checked){
		FH9 = "FH9";
		document.getElementById("fpsychiatristViiw").style.display="block";
		}
		else{
			FH9 = "";
			document.getElementById("fpsychiatristViiw").style.display="block";
		}
		
		if(document.getElementById("FH11").checked){
		FH11 = "FH11";
		//document.getElementById("eEndocrineView").style.display="block";
		}
		else{
			FH11 = "";
			//document.getElementById("eEndocrineView").style.display="block";
		}
		if(document.getElementById("FH12").checked){
		FH12 = "FH12";
		//document.getElementById("eEndocrineView").style.display="block";
		}
		else{
			FH12 = "";
			//document.getElementById("eEndocrineView").style.display="block";
		}
	   var historyIllness= "fever";
	      var familyHistoryOthr= "Diseases Surgery";
	      var caseAdmType= "PLN";
	      var pastHistoryCancers= "stage 1";
	      var pastHistoryEnddis ="stage crossed";
	      var pastHistorySurg ="critical";
	      var legalCaseCheck ="Y";
	      var legalCaseNo ="1234567345";
	      var policeStatName ="Kokapet";
	      onRegister();
			$.ajax({
        type: "POST",
        url: ""+$('#ctx').attr('content')+"/catchPastFamilyHistory",
      
        data: {
			"txnid":txnid,
			"historyIllness": historyIllness,
			"pastHistory": PH12+'~'+PH1+'~'+PH2+'~'+PH3+'~'+PH4+'~'+PH5+'~'+PH7+'~'+PH8+'~'+PH9+'~'+PH10+'~'+PH11+'~'+PH13,
			"pastHistoryOthr": "any other issue",
			"familyHistory": FH1+'~'+FH2+'~'+FH3+'~'+FH4+'~'+FH5+'~'+FH6+'~'+FH7+'~'+FH8+'~'+FH9+'~'+FH11+'~'+FH12,
			"familyHistoryOthr": familyHistoryOthr,
			"caseAdmType": caseAdmType,
			"pastHistoryCancers": pastHistoryCancers,
			"pastHistoryEnddis": pastHistoryEnddis,
			"pastHistorySurg": pastHistorySurg,
			"legalCaseCheck": legalCaseCheck,
			"legalCaseNo": legalCaseNo,
			"policeStatName": policeStatName,

        },
        success: function (data) {
		  offRegister();	
          if (data == "SUCCESS") {
	 		 document.getElementById("familysuccmsg").innerHTML="Data  Saved";
			 document.getElementById("familysuccmsgdiv").style.display="block";
          }
           else if(data=="FAILURE"){
				 document.getElementById("familyfailmsg").innerHTML=data1.message;
				 document.getElementById("familyfailmsgDiv").style.display="block";
			}
           else {
            alert('API Gateway not respond. Please try again.');
          }
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }

      });
}


 function preAuthAdmissionDetails(){
	
	var txnid = document.getElementById("txnid").value;
    var caseType = document.getElementById("caseType").value;
	var treatmentDate = document.getElementById("treatmentDate").value;
	var admissionDt = document.getElementById("admissionDt").value;
	var packageCost = document.getElementById("packageCost").value;
	var totPckgAmt = document.getElementById("totPckgAmt").value;
	var remarks = document.getElementById("remarks").value;
	var patientId = document.getElementById("patientId").value;
	var patientState = document.getElementById("patientState").value;
	var hospState = document.getElementById("hospState").value;
	var caseHospCode = document.getElementById("caseHospCode").value;
	var autoApprovalFlag = document.getElementById("autoApprovalFlag").value;
	var enhFlag = document.getElementById("enhFlag").value;
	var isCovidCase = document.getElementById("isCovidCase").value;
	var crtUsr = document.getElementById("crtUsr").value;
	var hospGrade = document.getElementById("hospGrade").value;
	
	
	if(caseType==""){
		document.getElementById("admissionDetailError").innerHTML="Please Select Admission Type";
		document.getElementById("caseType").focus();
	    return false;
	}
	
	if(treatmentDate==""){
		document.getElementById("admissionDetailError").innerHTML="Please Select Treatment Date";
		document.getElementById("treatmentDate").focus();
	    return false;
	}
	
	if(admissionDt==""){
		document.getElementById("admissionDetailError").innerHTML="Please Select Adminssion Date";
		document.getElementById("admissionDt").focus();
	    return false;
	}
	var option=document.getElementsByName('medico');
     
	if (!(option[0].checked || option[1].checked)) {
	    document.getElementById("admissionDetailError").innerHTML="Please Checked Medico Legal Case";
	    document.getElementById("medico1").focus();
	    return false;
	}
	
	
	var medico;
	if( document.getElementById("medico1").checked){
		medico="Y";
		document.getElementById("medicoView").innerHTML="Y";
		var firLmc = document.getElementById("firLmc").value;
		var policeStation = document.getElementById("policeStation").value; 
		if(firLmc==""){
			 document.getElementById("admissionDetailError").innerHTML="Please Enter Fir LMC Number";
			 document.getElementById("firLmc").focus();
	   		 return false;
		}
		if(policeStation==""){
			 document.getElementById("admissionDetailError").innerHTML="Please Enter police Station";
			 document.getElementById("policeStation").focus();
	   		 return false;
		}
	}
	else{
		medico="N";
		document.getElementById("medicoView").innerHTML="N";
		document.getElementById("admissionDetailError").innerHTML="";
	}
		onRegister();
		$.ajax({
        type: "POST",
        url: ""+$('#ctx').attr('content')+"/catchPreAuthAdmissionDetail",
      
        data: {
		  "txnid":txnid,
		  "patientId": patientId,
          "patientState": patientState,
          "hospState": hospState,
          "caseHospCode": caseHospCode,
          "autoApprovalFlag": autoApprovalFlag,
          "enhFlag": enhFlag,
          "isCovidCase": isCovidCase,
          "crtUsr": crtUsr,
          "hospGrade": hospGrade,
          "caseType": caseType,
          "treatmentDate": treatmentDate,
          "admissionDt": admissionDt,
          "packageCost": packageCost,
          "totPckgAmt": totPckgAmt,
          "medico": medico,   
          "remarks":remarks,  
        },
        success: function (data) {
			 offRegister();
             if (data == "SUCCESS") {
	 		 document.getElementById("adminssionsuccmsg").innerHTML="Data  Saved";
			 document.getElementById("adminssionsuccmsgdiv").style.display="block";
			// $('#succmsgdiv').delay(5000).fadeOut(400);
			 document.getElementById("admissionType").innerHTML="caseType";
			 document.getElementById("treatmentDateView").innerHTML="treatmentDate";
		     document.getElementById("admissionDateView").innerHTML="admissionDt";
		     document.getElementById("packageCostView").innerHTML="packageCost";
		     document.getElementById("totaCostView").innerHTML="totPckgAmt";
		     document.getElementById("remarksView").innerHTML="remarks";
			 document.getElementById("incentiveView").innerHTML="110%";      
			
          }
           else if(data=="FAILURE"){
				 document.getElementById("adminssionfailmsg").innerHTML=data1.message;
				 document.getElementById("adminssionfailmsgDiv").style.display="block";
			}
           else {
            alert('API Gateway not respond. Please try again.');
          }
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }

      });
}


 function stratificationDetails(){
	var txnid = document.getElementById("txnid").value;
    var stratCode = document.getElementById("stratCode").value;
	var stratDtls = document.getElementById("stratDtls").value;
	var stratName = document.getElementById("stratName").value;
	var stratCost = document.getElementById("stratCost").value;
	var totalStratCost = document.getElementById("totalStratCost").value;
	var noOfUnits = document.getElementById("noOfUnits").value;
	var stratProcCode = document.getElementById("stratProcCode").value;
	if(stratProcCode ==""){
		alert("You can not add stratification");
		return false;
	}
	if(stratCode ==""){
		alert("Please select Stratification Code");
		return false;
	}
	if(noOfUnits ==""){
		alert("Please Enter No of Unit");
		return false;
	}
	
	onRegister();
		$.ajax({
        type: "POST",
        url: ""+$('#ctx').attr('content')+"/catchStratificationDetail",
      
        data: {
		  "txnid":txnid,
		  "stratCode": stratCode,
          "stratDtls": stratDtls,
          "stratName": stratName,
          "stratCost": stratCost,
          "totalStratCost": totalStratCost,
          "noOfUnits": noOfUnits,
          
        },
        success: function (data) {
		  offRegister();
        	//var data1 = jQuery.parseJSON( newData );
			var data2 = newData.data;
	        newData = data;
			var data2 = newData.data;
			if (data2.length!=0 && newData.message == "SUCCESS") {
				$("#stratificationData").dataTable().fnClearTable();
				$("#stratificationData").dataTable().fnDraw();
				$("#stratificationData").dataTable().fnDestroy();
		        $('#stratificationData').DataTable( {	
			     "responsive": true, "lengthChange": true, "autoWidth": false,"paging": false, "searching": false,"lengthMenu": false,
		         "language": {"emptyTable": "No Data available"  },
		         "searching": false, info: false,
		         "aaData": data2,
		  		  "aoColumns": [ 
			  		    { "mData": "stratCode"},          
			  		    { "mData": "stratDtls"},
			  		    { "mData": "stratName"},
			  		    { "mData": "stratCost"},
			  		    { "mData": "totalStratCost"},
			  		    { "mData": "noOfUnits"},
			  		    {
							"mData": function(data2, type, row) {
								return '<button type="button" value="' + data2.txnid + '^^' + data2.tempId + '"  onclick="deleteCatchStratificationData(this.value)" class="btn btn-sm btn-primary btn-floting" style="border-radius: 50%;" data-toggle="modal" data-keyboard="false" data-backdrop="static" data-target="#modal-revoke" style="background: #2c2d6e;"><i class="fa fa-minus"></i></button>';
							}
						}
				 	]
		  		})				
			}else if(newData.message == "FAILURE"){
				alert('Api not Responding, Please try Again Later..!');	
			}
    
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }

      });
}

 function implantDetails(){
	var txnid = document.getElementById("txnid").value;
    var implantCode = document.getElementById("implantCode").value;
	var implantName = document.getElementById("implantName").value;
	var implantCost = document.getElementById("implantCost").value;
	var implantCount = document.getElementById("implantCount").value;
	var maximumMultiplier = document.getElementById("maximumMultiplier").value;
	var totalImplantCost = document.getElementById("totalImplantCost").value;
	
	var implantProcCode = document.getElementById("implantProcCode").value;
	
	
	if(implantProcCode==""){
		alert("You can not add implant");
		return false;
	}
	
	if(implantCode==""){
		alert("Please Select Implant Code");
		return false;
	}
		if(implantCount==""){
		alert("Please Enter Implant Count");
		return false;
	}
	
		if(maximumMultiplier==""){
		alert("Please Enter Maximum Muptiplier ");
		return false;
	}
	
	onRegister();
		$.ajax({
        type: "POST",
        url: ""+$('#ctx').attr('content')+"/catchImplantDetail",
      
        data: {
		  "txnid":txnid,
		  "implantCode": implantCode,
          "implantName": implantName,
          "implantCost": implantCost,
          "implantCount": implantCount,
          "maximumMultiplier": maximumMultiplier,
          "totalImplantCost": totalImplantCost,
          
        },
        success: function (data) {
		  offRegister();
         //var data1 = jQuery.parseJSON( newData );
			var data2 = newData.data;
	        newData = data;
			var data2 = newData.data;
			if (data2.length!=0 && newData.message == "SUCCESS") {
				$("#implantData").dataTable().fnClearTable();
				$("#implantData").dataTable().fnDraw();
				$("#implantData").dataTable().fnDestroy();
		        $('#implantData').DataTable( {	
			     "responsive": true, "lengthChange": true, "autoWidth": false,"paging": false, "searching": false,"lengthMenu": false,
		         "language": {"emptyTable": "No Data available"  },
		         "searching": false, info: false,
		         "aaData": data2,
		  		  "aoColumns": [ 
			  		    { "mData": "implantCode"},          
			  		    { "mData": "implantName"},
			  		    { "mData": "implantCost"},
			  		    { "mData": "implantCount"},
			  		    { "mData": "maximumMultiplier"},
			  		    { "mData": "totalImplantCost"},
			  		    {
							"mData": function(data2, type, row) {
								return '<button type="button" value="' + data2.txnid + '^^' + data2.tempId + '"  onclick="deleteCatchStratificationData(this.value)" class="btn btn-sm btn-primary btn-floting" style="border-radius: 50%;" data-toggle="modal" data-keyboard="false" data-backdrop="static" data-target="#modal-revoke" style="background: #2c2d6e;"><i class="fa fa-minus"></i></button>';
							}
						}
				 	]
		  		})				
			}
			else if(newData.message == "FAILURE"){
				alert('Api not Responding, Please try Again Later..!');	
			}
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }

      });
}




function getImplantDetailData(txnid) {
	$.ajax({
		type: "POST",
		url: "" + $('#ctx').attr('content') + "/getImplantDetailData",
		data: {
			"txnid": txnid
		},
		success: function(data) {
			newData = data;
			var data2 = newData.data;
			console.log("txnid"+data2)
			if (data2.length!=0 && newData.message == "SUCCESS") {
				$("#implantData").dataTable().fnClearTable();
				$("#implantData").dataTable().fnDraw();
				$("#implantData").dataTable().fnDestroy();
		        $('#stratificationData').DataTable( {	
			     "responsive": true, "lengthChange": true, "autoWidth": false,"paging": false, "searching": false,"lengthMenu": false,
		         "language": {"emptyTable": "No Data available"  },
		         "searching": false, info: false,
		         "aaData": data2,
		  		 "aoColumns": [ 
			  		    { "mData": "implantCode"},          
			  		    { "mData": "implantName"},
			  		    { "mData": "implantCost"},
			  		    { "mData": "implantCount"},
			  		    { "mData": "maximumMultiplier"},
			  		    { "mData": "totalImplantCost"},
			  		    {
							"mData": function(data2, type, row) {
								return '<button type="button" value="' + data2.txnid + '^^' + data2.tempId + '"  onclick="deleteCacheImplantData(this.value)" class="btn btn-sm btn-primary btn-floting" style="border-radius: 50%;" data-toggle="modal" data-keyboard="false" data-backdrop="static" data-target="#modal-revoke" style="background: #2c2d6e;"><i class="fa fa-minus"></i></button>';
							}
						}
				 	]
		  		})				
			}else if(newData.message == "FAILURE"){
				alert('Api not Responding, Please try Again Later..!');	
			}
		},
		error: function() {
			alert('Api not Responding, Please try Again Later..!');
		}
	});	
}

function deleteCacheImplantData(deleteDaignoseData) {
	const myArray = deleteDaignoseData.split("^^");
	var txnid = myArray[0];
	var tempId = myArray[1];
	$.ajax({
		type: "POST",
		url: "" + $('#ctx').attr('content') + "/deleteCacheImplantData",
		data: {
			"txnid": txnid,
			"tempId": tempId,
		},
		success: function(data) {
			newData = data;
			if (newData == "SUCCESS") {
				$("#implantData").dataTable().fnClearTable();
				$("#implantData").dataTable().fnDraw();
				$("#implantData").dataTable().fnDestroy();
				window.setTimeout(function(){getCatchStratificationData(txnid)},100);
			}else {
	        	alert('API Gateway not respond. Please try again.');
	        }
		},
		error: function() {
			alert('Api not Responding, Please try Again Later..!');
		}
	});
}





function erupiInvestigationDetail(){
	//var txnid = document.getElementById("txnid").value;
    
		var formData = new FormData(investigationAttachmentDetail);
		onRegister();
		$.ajax({
         type: "POST",
	     url:""+$('#ctx').attr('content')+"/catchInvestigationDetail",
         data: formData,
         processData: false,
         contentType: false,     
        success: function (data) {
		  offRegister();
          if (data == "SUCCESS") {
	 		 document.getElementById("investsuccmsg").innerHTML="Data  Saved";
			 document.getElementById("investsuccmsgdiv").style.display="block";
			// $('#succmsgdiv').delay(5000).fadeOut(400);
			// document.getElementById("investAttachName").innerHTML=investigationName;
			// document.getElementById("investImageName").innerHTML=investCode;
		    // document.getElementById("investImage").innerHTML=quantity;		
          }
           else if(data=="FAILURE"){
				 document.getElementById("investfailmsg").innerHTML=data1.message;
				 document.getElementById("investfailmsgDiv").style.display="block";
			}
           else {
            alert('API Gateway not respond. Please try again.');
          }
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }

      });
}


function erupiDetails(){
	var txnid = document.getElementById("txnid").value;
    var investigationName = document.getElementById("investigationName").value;
	var investCode = document.getElementById("investCode").value;
	var quantity = document.getElementById("quantity").value;
	var unitAmount = document.getElementById("unitAmount").value;
	var totalAmount = document.getElementById("totalAmount").value;
	var maxQuantity = document.getElementById("maxQuantity").value;
	var minQuantity = document.getElementById("minQuantity").value;
	
		onRegister();
		$.ajax({
        type: "POST",
        url: ""+$('#ctx').attr('content')+"/catchErupiDetail",
      
        data: {
		 // "txnid":txnid,
		  "investigationName": investigationName,
          "investCode": investCode,
          "quantity": quantity,
          "unitAmount": unitAmount,
          "totalAmount": totalAmount,
         // "totalImplantCost": totalImplantCost,
          "maxQuantity":maxQuantity,
          "minQuantity":minQuantity,
        },
        success: function (data) {
		  offRegister();
          if (data == "SUCCESS") {
	 		 document.getElementById("erupysuccmsg").innerHTML="Data  Saved";
			 document.getElementById("erupysuccmsgdiv").style.display="block";
			// $('#succmsgdiv').delay(5000).fadeOut(400);
			 document.getElementById("erupyNameView").innerHTML=investigationName;
			 document.getElementById("erupiCodeView").innerHTML=investCode;
		     document.getElementById("erupyQuantityView").innerHTML=quantity;
		     document.getElementById("erupiUnitView").innerHTML=unitAmount;
		     document.getElementById("erupyTotalView").innerHTML=totalAmount;
		     document.getElementById("erupyMaxView").innerHTML=maxQuantity;
		     document.getElementById("erupyMixView").innerHTML=minQuantity;	
          }
           else if(data=="FAILURE"){
				 document.getElementById("erupyfailmsg").innerHTML=data1.message;
				 document.getElementById("erupyfailmsgDiv").style.display="block";
				// $('#failmsgDiv').delay(5000).fadeOut(400);
				 //window.location.reload();
			}
           else {
            alert('API Gateway not respond. Please try again.');
          }
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }

      });
	}


	function preAuthFinalSubmit(){
	    var txnid = document.getElementById("txnid").value;
	    onRegister();
		$.ajax({
        type: "POST",
        url: ""+$('#ctx').attr('content')+"/finalSubmitPreAuth",
        data: {
         "txnid":txnid,
        },
        success: function (data) {
		offRegister();
	    console.log("final submit"+data)
	    var obj = jQuery.parseJSON(data);
	    var obj2  = obj.data;
          if (obj.status == "SUCCESS") {
		 		 document.getElementById("finalsuccmsg").innerHTML=""+obj2.message;
				 document.getElementById("finalsuccmsgdiv").style.display="block";
				// $('#succmsgdiv').delay(5000).fadeOut(400);
          }
           else if(obj.status=="FAILURE"){
				 document.getElementById("finalfailmsg").innerHTML=""+obj2.message;
				 document.getElementById("finalfailmsgDiv").style.display="block";
				// $('#failmsgDiv').delay(5000).fadeOut(400);
				 //window.location.reload();
			}
           else {
            alert('API Gateway not respond. Please try again.');
          }
        },
        error: function (e) {
         	alert('API Gateway not respond. Please try again.');
        }

      });
}


